<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Alternatives Guide — TechFreedom</title>
    <meta name="description" content="European and open-source alternatives to your Big Tech tools. Scored, compared, and ready to evaluate.">
    <link rel="canonical" href="https://techfreedom.eu/alternatives/">
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://techfreedom.eu/alternatives/">
    <meta property="og:title" content="Your Alternatives Guide — TechFreedom">
    <meta property="og:description" content="European and open-source alternatives to your Big Tech tools. Scored, compared, and ready to evaluate.">
    <meta property="og:image" content="https://techfreedom.eu/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_GB">
    <meta property="og:site_name" content="TechFreedom">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Your Alternatives Guide — TechFreedom">
    <meta name="twitter:description" content="European and open-source alternatives to your Big Tech tools.">
    <meta name="twitter:image" content="https://techfreedom.eu/og-image.png">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%231A2332'/%3E%3Ctext x='16' y='24' font-family='Georgia,serif' font-size='22' font-weight='400' fill='%23F7F5F0' text-anchor='middle'%3ETf%3C/text%3E%3C/svg%3E">
    <script defer data-domain="techfreedom.eu" src="https://plausible.io/js/script.js"></script>
    <!-- Privacy-friendly fonts (Bunny Fonts) -->
    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=dm-sans:400,400i,500,500i,700,700i&display=swap" rel="stylesheet" />
    <link href="https://fonts.bunny.net/css?family=fraunces:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../css/shared.css">
    <style>
        /* ========================================
           ALTERNATIVES PAGE STYLES
           ======================================== */

        /* --- Page Header --- */
        .alt-header {
            padding: calc(var(--space-2xl) + 60px) 0 var(--space-xl) 0;
            background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-warm) 100%);
        }

        .alt-header h1 {
            font-size: clamp(2rem, 1.5rem + 2.5vw, 3.5rem);
            font-weight: 300;
            margin-bottom: var(--space-s);
            font-variation-settings: 'opsz' 72;
        }

        .alt-header .tagline {
            font-family: var(--font-display);
            font-size: clamp(1.1rem, 1rem + 0.5vw, 1.35rem);
            font-weight: 300;
            font-style: italic;
            color: var(--accent-sky);
            margin-bottom: var(--space-m);
            font-variation-settings: 'opsz' 36;
        }

        .alt-header p:last-child {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        /* --- No-Tools State --- */
        .no-tools-section {
            padding: var(--space-xl) 0;
            text-align: center;
        }

        .no-tools-section[hidden] {
            display: none;
        }

        .no-tools-section p {
            margin: 0 auto var(--space-m) auto;
            color: var(--text-secondary);
            font-size: 1.05rem;
            line-height: 1.8;
        }

        .no-tools-section .assess-btn {
            display: inline-block;
            padding: 0.85em 2em;
            font-family: var(--font-body);
            font-size: 0.95rem;
            font-weight: 500;
            background: var(--accent-amber);
            color: var(--text-primary);
            border: none;
            border-radius: 4px;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(212, 168, 67, 0.2);
        }

        .no-tools-section .assess-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(212, 168, 67, 0.3);
            color: var(--text-primary);
        }

        /* --- Alternatives Section --- */
        .alternatives-section {
            padding: var(--space-l) 0 var(--space-xl) 0;
        }

        .alternatives-section[hidden] {
            display: none;
        }

        /* --- Tool Groups --- */
        .tool-group {
            margin-bottom: var(--space-xl);
        }

        .tool-group-header {
            display: flex;
            align-items: baseline;
            gap: var(--space-s);
            margin-bottom: var(--space-m);
            padding-bottom: var(--space-xs);
            border-bottom: 1px solid var(--horizon);
        }

        .tool-group-header h2 {
            font-size: clamp(1.25rem, 1rem + 1.25vw, 1.75rem);
            font-weight: 400;
            font-variation-settings: 'opsz' 48;
        }

        .tool-group-header h2 strong {
            font-weight: 500;
        }

        .tool-group-risk {
            display: inline-block;
            padding: 0.15em 0.5em;
            border-radius: 3px;
            font-family: var(--font-body);
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .tool-group-risk.low { background: #E8F5E9; color: #2E7D32; }
        .tool-group-risk.medium { background: #FFF8E1; color: #F57F17; }
        .tool-group-risk.high { background: #FBE9E7; color: #D84315; }
        .tool-group-risk.critical { background: #FFEBEE; color: #C62828; }

        /* --- Alternative Cards Grid --- */
        .alt-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-m);
        }

        /* --- Alternative Card --- */
        .alt-card {
            padding: var(--space-l);
            background: linear-gradient(135deg, rgba(247, 245, 240, 0.8) 0%, rgba(255,255,255,0.6) 100%);
            border: 1px solid var(--horizon);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .alt-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
        }

        .alt-card h3 {
            font-size: 1.15rem;
            font-weight: 400;
            margin-bottom: var(--space-xs);
        }

        .alt-card-meta {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: var(--space-s);
        }

        .alt-card-category {
            display: inline-block;
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: var(--space-s);
        }

        /* --- Badges --- */
        .alt-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4em;
            margin-bottom: var(--space-s);
        }

        .alt-badge {
            display: inline-block;
            padding: 0.2em 0.5em;
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.03em;
            border-radius: 3px;
            white-space: nowrap;
        }

        .alt-badge--open-source {
            background: #E8F5E9;
            color: #2E7D32;
        }

        .alt-badge--self-hostable {
            background: #E3F2FD;
            color: #1565C0;
        }

        .alt-badge--eu-uk {
            background: #FFF8E1;
            color: #F57F17;
        }

        .alt-badge--also-replaces {
            background: var(--accent-sky-light);
            color: var(--accent-sky);
        }

        /* --- Gated Content (scores/details - always visible) --- */
        .gated-content {
            margin-top: var(--space-s);
        }

        /* --- Gated Identity (name/provider - blurred when locked) --- */
        .gated-identity.locked {
            position: relative;
            filter: blur(6px);
            user-select: none;
            pointer-events: none;
        }

        .gated-identity.locked::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                180deg,
                rgba(247, 245, 240, 0.3) 0%,
                rgba(247, 245, 240, 0.5) 100%
            );
            pointer-events: none;
        }

        .gated-scores {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.4em;
            margin-bottom: var(--space-s);
        }

        .gated-score-cell {
            text-align: center;
        }

        .gated-score-label {
            display: block;
            font-size: 0.6rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 0.25em;
        }

        .gated-score-value {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2em;
            height: 2em;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.8rem;
            color: var(--white);
        }

        .score-1 { background: #2E7D32; }
        .score-2 { background: #689F38; }
        .score-3 { background: #F9A825; color: var(--text-primary); }
        .score-4 { background: #EF6C00; }
        .score-5 { background: #C62828; }

        .risk-comparison {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: var(--space-s);
            padding-top: var(--space-s);
            border-top: 1px solid var(--horizon);
        }

        .risk-comparison strong {
            color: var(--text-primary);
        }

        .risk-comparison-score {
            font-weight: 700;
        }

        .risk-comparison-score.improvement {
            color: #2E7D32;
        }

        .risk-comparison-score.worse {
            color: #C62828;
        }

        .risk-comparison-score.neutral {
            color: var(--text-muted);
        }

        .risk-comparison-diff {
            font-weight: 400;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .gated-detail {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 0.4em;
        }

        .gated-detail strong {
            color: var(--text-primary);
            font-weight: 500;
        }

        .gated-tradeoffs {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-top: var(--space-xs);
            padding-top: var(--space-xs);
            border-top: 1px solid var(--horizon);
        }

        /* --- Unlock Section --- */
        .unlock-section {
            padding: var(--space-l) 0 var(--space-xl) 0;
            background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-warm) 40%, var(--bg-mist) 100%);
        }

        .unlock-section[hidden] {
            display: none;
        }

        .unlock-card {
            max-width: 560px;
            margin: 0 auto;
            padding: var(--space-l);
            background: linear-gradient(135deg, rgba(247, 245, 240, 0.8) 0%, rgba(255,255,255,0.6) 100%);
            border: 1px solid var(--horizon);
            border-radius: 8px;
            text-align: center;
        }

        .unlock-card h2 {
            font-size: clamp(1.25rem, 1rem + 1vw, 1.75rem);
            font-weight: 400;
            margin-bottom: var(--space-xs);
            font-variation-settings: 'opsz' 48;
        }

        .unlock-card p {
            margin: 0 auto var(--space-m) auto;
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .unlock-card .unlock-btn {
            display: inline-block;
            padding: 0.85em 2em;
            font-family: var(--font-body);
            font-size: 0.95rem;
            font-weight: 500;
            background: var(--accent-amber);
            color: var(--text-primary);
            border: none;
            border-radius: 4px;
            cursor: default;
            opacity: 0.7;
            box-shadow: 0 1px 3px rgba(212, 168, 67, 0.2);
        }

        .unlock-note {
            display: block;
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: var(--space-xs);
            font-style: italic;
        }

        /* --- Loading / Error --- */
        .loading-state {
            text-align: center;
            padding: var(--space-xl);
            color: var(--text-muted);
        }

        .error-banner {
            padding: var(--space-s) var(--space-m);
            background: #FFF3E0;
            border-left: 3px solid #EF6C00;
            border-radius: 0 4px 4px 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-m);
        }

        /* ========================================
           RESPONSIVE
           ======================================== */
        @media (max-width: 768px) {
            .alt-cards-grid {
                grid-template-columns: 1fr;
            }

            .tool-group-header {
                flex-direction: column;
                gap: var(--space-xs);
            }

            .gated-scores {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        @media (max-width: 480px) {
            .alt-header {
                padding-top: calc(var(--space-xl) + 60px);
            }

            .alt-card {
                padding: var(--space-m);
            }

            .gated-scores {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .alt-card:hover {
                transform: none;
            }
        }
    </style>
</head>
<body>

    <a class="skip-link" href="#main-content">Skip to main content</a>

    <nav class="site-nav" aria-label="Main navigation">
        <a href="/" class="nav-wordmark"><svg class="nav-icon" aria-hidden="true" width="32" height="32" viewBox="0 0 32 32"><rect width="32" height="32" rx="6" fill="#1A2332"/><text x="16" y="24" font-family="Georgia,serif" font-size="22" font-weight="400" fill="#F7F5F0" text-anchor="middle">Tf</text></svg><span class="nav-wordmark-text">TechFreedom</span></a>
        <ul class="nav-links">
            <li><a href="/manifesto/">Manifesto</a></li>
            <li><a href="/assess/">Assessment</a></li>
            <li><a href="/programme/">Programme</a></li>
        </ul>
    </nav>

    <header class="alt-header">
        <div class="section-inner section-inner--wide">
            <h1 class="reveal">Your Alternatives Guide</h1>
            <p class="tagline reveal reveal-delay-1">European and open-source alternatives to your current tools.</p>
            <p class="reveal reveal-delay-2">For each tool in your stack, we show you alternatives that respect your data, your autonomy, and your budget. Scores, costs, and migration details are available with the full guide.</p>
        </div>
    </header>

    <main id="main-content" tabindex="-1">

        <!-- No tools state -->
        <section class="no-tools-section" id="no-tools-section" hidden aria-labelledby="no-tools-heading">
            <div class="section-inner">
                <h2 id="no-tools-heading" class="reveal">Start with your assessment</h2>
                <p class="reveal reveal-delay-1">To see relevant alternatives, we need to know which tools you are using. Run a quick risk assessment first and we will show you what else is out there.</p>
                <a href="/assess/" class="assess-btn reveal reveal-delay-2">Take the assessment</a>
            </div>
        </section>

        <!-- Alternatives (populated by JS) -->
        <section class="alternatives-section" id="alternatives-section" hidden aria-labelledby="alternatives-heading">
            <div class="section-inner section-inner--wide">
                <h2 id="alternatives-heading" class="visually-hidden">Alternatives by tool</h2>
                <div id="alternatives-container">
                    <!-- Tool groups rendered by JS -->
                </div>
            </div>
        </section>

        <!-- Unlock CTA -->
        <section class="unlock-section" id="unlock-section" hidden aria-labelledby="unlock-heading">
            <div class="section-inner">
                <div class="unlock-card reveal">
                    <h2 id="unlock-heading">Unlock the full guide</h2>
                    <p>Get detailed risk scores, real costs, migration difficulty ratings, and honest trade-off analysis for every alternative.</p>
                    <span class="unlock-btn">Get access &mdash; coming soon</span>
                    <span class="unlock-note">One-time purchase. No subscription.</span>
                </div>
            </div>
        </section>

    </main>

    <!-- ============ FOOTER ============ -->
    <footer class="site-footer">
        <div class="section-inner">
            <div class="footer-inner">
                <p class="footer-copyright">CC BY TechFreedom 2026</p>
            </div>
        </div>
    </footer>

    <script>
    (function() {
        'use strict';

        /* ========================================
           CONFIGURATION
           ======================================== */
        var DATA_SOURCE = 'static';   // 'static' = JSON files, 'api' = PocketBase
        var API_BASE = 'https://api.techfreedom.eu';
        var STATIC_BASE = '../assess/data';
        var IS_UNLOCKED = false;      // Phase 3: set true when payment verified

        /* ========================================
           SLUG ALIASES
           Map shorthand alternativeTo slugs to actual tool slugs
           ======================================== */
        var SLUG_ALIASES = {
            'gmail': 'gmail-free',
            'outlook': 'microsoft-365',
            'm365': 'microsoft-365',
            'teams': 'microsoft-teams',
            'google-docs': 'google-workspace',
            'google-meet': 'google-workspace',
            'google-drive': 'google-workspace',
            'monday': 'monday-com',
            'medium': 'wordpress-com',
            'azure': 'aws',
            'gcp': 'aws',
            'godaddy': 'aws',
            'figma': 'canva',
            'miro': 'trello',
            'mural': 'trello',
            'substack': 'mailchimp'
        };

        /* ========================================
           EMBEDDED FALLBACK DATA
           ======================================== */
        var TOOLS_FALLBACK = [
            {id:1,name:"Google Workspace (Gmail, Drive, Docs, Sheets, Calendar, Meet)",slug:"google-workspace",category:"Productivity Suite",provider:"Google LLC (Alphabet)",hqCountry:"United States",jurisdiction:4,continuity:3,surveillance:5,lockIn:4,costExposure:3,total:19,riskLevel:"High"},
            {id:2,name:"Gmail (free/personal)",slug:"gmail-free",category:"Email",provider:"Google LLC",hqCountry:"United States",jurisdiction:5,continuity:2,surveillance:5,lockIn:3,costExposure:1,total:16,riskLevel:"High"},
            {id:3,name:"Microsoft 365 (Outlook, OneDrive, Word, Excel, Teams, SharePoint)",slug:"microsoft-365",category:"Productivity Suite",provider:"Microsoft Corp",hqCountry:"United States",jurisdiction:3,continuity:3,surveillance:4,lockIn:5,costExposure:4,total:19,riskLevel:"High"},
            {id:4,name:"Microsoft Teams",slug:"microsoft-teams",category:"Communication",provider:"Microsoft Corp",hqCountry:"United States",jurisdiction:3,continuity:3,surveillance:4,lockIn:5,costExposure:4,total:19,riskLevel:"High"},
            {id:5,name:"Slack",slug:"slack",category:"Communication",provider:"Salesforce",hqCountry:"United States",jurisdiction:4,continuity:3,surveillance:3,lockIn:3,costExposure:4,total:17,riskLevel:"High"},
            {id:6,name:"Zoom",slug:"zoom",category:"Video Conferencing",provider:"Zoom Video Communications",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:4,lockIn:2,costExposure:3,total:15,riskLevel:"High"},
            {id:7,name:"WhatsApp (organisational use)",slug:"whatsapp",category:"Messaging",provider:"Meta Platforms",hqCountry:"United States",jurisdiction:5,continuity:2,surveillance:5,lockIn:2,costExposure:1,total:15,riskLevel:"High"},
            {id:8,name:"Dropbox",slug:"dropbox",category:"Cloud Storage",provider:"Dropbox Inc",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:3,lockIn:2,costExposure:3,total:14,riskLevel:"Medium"},
            {id:9,name:"Salesforce",slug:"salesforce",category:"CRM",provider:"Salesforce Inc",hqCountry:"United States",jurisdiction:3,continuity:4,surveillance:3,lockIn:5,costExposure:5,total:20,riskLevel:"Critical"},
            {id:10,name:"HubSpot",slug:"hubspot",category:"CRM",provider:"HubSpot Inc",hqCountry:"United States",jurisdiction:4,continuity:3,surveillance:3,lockIn:4,costExposure:4,total:18,riskLevel:"High"},
            {id:11,name:"Canva",slug:"canva",category:"Design",provider:"Canva Pty Ltd",hqCountry:"Australia",jurisdiction:4,continuity:2,surveillance:3,lockIn:3,costExposure:3,total:15,riskLevel:"High"},
            {id:12,name:"Mailchimp",slug:"mailchimp",category:"Email Marketing",provider:"Intuit (Mailchimp)",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:4,lockIn:3,costExposure:4,total:17,riskLevel:"High"},
            {id:13,name:"Trello",slug:"trello",category:"Project Management",provider:"Atlassian",hqCountry:"Australia/US",jurisdiction:4,continuity:2,surveillance:3,lockIn:2,costExposure:3,total:14,riskLevel:"Medium"},
            {id:14,name:"Monday.com",slug:"monday-com",category:"Project Management",provider:"Monday.com Ltd",hqCountry:"Israel/US",jurisdiction:4,continuity:2,surveillance:3,lockIn:3,costExposure:4,total:16,riskLevel:"High"},
            {id:15,name:"Asana",slug:"asana",category:"Project Management",provider:"Asana Inc",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:3,lockIn:3,costExposure:4,total:16,riskLevel:"High"},
            {id:16,name:"WordPress.com (hosted)",slug:"wordpress-com",category:"Website / CMS",provider:"Automattic Inc",hqCountry:"United States",jurisdiction:3,continuity:2,surveillance:3,lockIn:3,costExposure:3,total:14,riskLevel:"Medium"},
            {id:17,name:"Squarespace",slug:"squarespace",category:"Website / CMS",provider:"Squarespace Inc",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:3,lockIn:4,costExposure:3,total:16,riskLevel:"High"},
            {id:18,name:"Wix",slug:"wix",category:"Website / CMS",provider:"Wix.com Ltd",hqCountry:"Israel/US",jurisdiction:4,continuity:2,surveillance:3,lockIn:5,costExposure:3,total:17,riskLevel:"High"},
            {id:19,name:"SurveyMonkey",slug:"surveymonkey",category:"Forms / Surveys",provider:"Momentive Global",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:3,lockIn:2,costExposure:4,total:15,riskLevel:"High"},
            {id:20,name:"Typeform",slug:"typeform",category:"Forms / Surveys",provider:"Typeform SL",hqCountry:"Spain/US",jurisdiction:3,continuity:2,surveillance:3,lockIn:2,costExposure:4,total:14,riskLevel:"Medium"},
            {id:21,name:"Google Forms",slug:"google-forms",category:"Forms / Surveys",provider:"Google LLC",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:5,lockIn:3,costExposure:1,total:15,riskLevel:"High"},
            {id:22,name:"Meta (Facebook / Instagram)",slug:"meta",category:"Social Media",provider:"Meta Platforms",hqCountry:"United States",jurisdiction:5,continuity:2,surveillance:5,lockIn:4,costExposure:2,total:18,riskLevel:"High"},
            {id:23,name:"X / Twitter",slug:"x-twitter",category:"Social Media",provider:"X Corp",hqCountry:"United States",jurisdiction:5,continuity:3,surveillance:5,lockIn:3,costExposure:2,total:18,riskLevel:"High"},
            {id:24,name:"LinkedIn",slug:"linkedin",category:"Social Media",provider:"Microsoft Corp",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:4,lockIn:4,costExposure:3,total:17,riskLevel:"High"},
            {id:25,name:"Calendly",slug:"calendly",category:"Scheduling",provider:"Calendly LLC",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:3,lockIn:2,costExposure:3,total:14,riskLevel:"Medium"},
            {id:26,name:"Eventbrite",slug:"eventbrite",category:"Events",provider:"Eventbrite Inc",hqCountry:"United States",jurisdiction:4,continuity:2,surveillance:3,lockIn:3,costExposure:3,total:15,riskLevel:"High"},
            {id:27,name:"Amazon Web Services",slug:"aws",category:"Cloud Infrastructure",provider:"Amazon.com Inc",hqCountry:"United States",jurisdiction:3,continuity:3,surveillance:3,lockIn:4,costExposure:4,total:17,riskLevel:"High"}
        ];

        var ALTERNATIVES_FALLBACK = [
            {id:1,name:"Proton Mail",slug:"proton-mail",category:"Email",alternativeTo:["gmail","outlook"],provider:"Proton AG",hqCountry:"Switzerland",openSource:"Partially",selfHostable:"No",dataHosting:"Switzerland",jurisdiction:1,continuity:2,surveillance:1,lockIn:2,costExposure:2,total:8,approxCost:"Free / \u20ac4\u20138/user/mo",migrationDifficulty:"Medium",tradeoffs:"Smaller ecosystem than Google. Calendar/Drive less mature. Excellent privacy and encryption.",lastReviewed:"Feb 2026"},
            {id:2,name:"Tutanota (Tuta)",slug:"tutanota",category:"Email",alternativeTo:["gmail","outlook"],provider:"Tutao GmbH",hqCountry:"Germany",openSource:"Yes",selfHostable:"No",dataHosting:"Germany",jurisdiction:1,continuity:2,surveillance:1,lockIn:2,costExposure:1,total:7,approxCost:"Free / \u20ac3\u20136/user/mo",migrationDifficulty:"Medium",tradeoffs:"Very privacy-focused. Own encryption (no IMAP). Calendar basic. Smaller feature set.",lastReviewed:"Feb 2026"},
            {id:3,name:"Fastmail",slug:"fastmail",category:"Email",alternativeTo:["gmail","outlook"],provider:"Fastmail Pty Ltd",hqCountry:"Australia",openSource:"No",selfHostable:"No",dataHosting:"Australia/US",jurisdiction:2,continuity:2,surveillance:2,lockIn:2,costExposure:2,total:10,approxCost:"\u00a32.50\u20135/user/mo",migrationDifficulty:"Low",tradeoffs:"Polished UI. Not open source. Standard protocols (IMAP). Good calendar integration.",lastReviewed:"Feb 2026"},
            {id:4,name:"Nextcloud + OnlyOffice",slug:"nextcloud-onlyoffice",category:"Productivity Suite",alternativeTo:["google-workspace","m365"],provider:"Nextcloud GmbH / Ascensio",hqCountry:"Germany / Latvia",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted / EU",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:2,total:7,approxCost:"Free (self-host) / \u20ac3\u20135/user hosted",migrationDifficulty:"High",tradeoffs:"Needs technical setup or managed hosting. Less polished than Google/MS. Powerful when configured. Full control.",lastReviewed:"Feb 2026"},
            {id:5,name:"CryptPad",slug:"cryptpad",category:"Docs & Collaboration",alternativeTo:["google-docs","m365"],provider:"XWiki SAS",hqCountry:"France",openSource:"Yes",selfHostable:"Yes",dataHosting:"France (EU)",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:1,total:6,approxCost:"Free / \u20ac5\u201315/mo",migrationDifficulty:"Medium",tradeoffs:"End-to-end encrypted. Includes forms, whiteboard, kanban. Simpler feature set. Very private.",lastReviewed:"Feb 2026"},
            {id:6,name:"CiviCRM",slug:"civicrm",category:"CRM",alternativeTo:["salesforce","hubspot"],provider:"CiviCRM LLC (community)",hqCountry:"Global (open source)",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:1,total:6,approxCost:"Free (self-host)",migrationDifficulty:"High",tradeoffs:"Powerful but complex. Needs technical support. Built for nonprofits. WordPress/Drupal integration.",lastReviewed:"Feb 2026"},
            {id:7,name:"Lamplight",slug:"lamplight",category:"CRM / Case Management",alternativeTo:["salesforce"],provider:"Lamplight Database Systems",hqCountry:"United Kingdom",openSource:"No",selfHostable:"No",dataHosting:"UK",jurisdiction:1,continuity:2,surveillance:1,lockIn:2,costExposure:2,total:8,approxCost:"From \u00a330/mo",migrationDifficulty:"Medium",tradeoffs:"UK-built for charities. Data in UK. Good sector understanding. Smaller company.",lastReviewed:"Feb 2026"},
            {id:8,name:"CharityLog",slug:"charitylog",category:"CRM / Case Management",alternativeTo:["salesforce"],provider:"Dizions Ltd",hqCountry:"United Kingdom",openSource:"No",selfHostable:"No",dataHosting:"UK",jurisdiction:1,continuity:2,surveillance:1,lockIn:2,costExposure:2,total:8,approxCost:"From \u00a350/mo",migrationDifficulty:"Medium",tradeoffs:"UK-built for service delivery charities. Strong reporting. Data in UK.",lastReviewed:"Feb 2026"},
            {id:9,name:"Beacon",slug:"beacon",category:"CRM / Fundraising",alternativeTo:["salesforce","hubspot"],provider:"Beacon Apps Ltd",hqCountry:"United Kingdom",openSource:"No",selfHostable:"No",dataHosting:"UK (AWS EU)",jurisdiction:1,continuity:2,surveillance:1,lockIn:2,costExposure:2,total:8,approxCost:"Free tier / from \u00a339/mo",migrationDifficulty:"Medium",tradeoffs:"Modern, well-designed. Built for UK charities. Free tier generous. Newer company.",lastReviewed:"Feb 2026"},
            {id:10,name:"Signal",slug:"signal",category:"Messaging",alternativeTo:["whatsapp","slack"],provider:"Signal Foundation",hqCountry:"US (nonprofit)",openSource:"Yes",selfHostable:"No",dataHosting:"Minimal server data",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:1,total:6,approxCost:"Free",migrationDifficulty:"Low",tradeoffs:"Best-in-class privacy. Nonprofit. Minimal metadata. Lacks org features (channels, threads).",lastReviewed:"Feb 2026"},
            {id:11,name:"Element / Matrix",slug:"element-matrix",category:"Messaging & Collaboration",alternativeTo:["slack","teams"],provider:"Element (New Vector Ltd)",hqCountry:"United Kingdom",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted / UK/EU",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:2,total:7,approxCost:"Free (self-host) / from \u00a34/user/mo",migrationDifficulty:"Medium",tradeoffs:"Decentralised protocol. Used by French/German governments. Steeper learning curve. Powerful.",lastReviewed:"Feb 2026"},
            {id:12,name:"Jitsi Meet",slug:"jitsi-meet",category:"Video Conferencing",alternativeTo:["zoom","teams","google-meet"],provider:"8x8 / Community",hqCountry:"Open source",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted / various",jurisdiction:1,continuity:1,surveillance:1,lockIn:1,costExposure:1,total:5,approxCost:"Free",migrationDifficulty:"Low",tradeoffs:"No account needed. Browser-based. Quality varies by server. Perfect for small meetings.",lastReviewed:"Feb 2026"},
            {id:13,name:"BigBlueButton",slug:"bigbluebutton",category:"Video Conferencing",alternativeTo:["zoom","teams"],provider:"BigBlueButton Inc",hqCountry:"Canada",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:1,total:6,approxCost:"Free (self-host)",migrationDifficulty:"Medium",tradeoffs:"Designed for education/workshops. Breakout rooms, whiteboard, polling built in.",lastReviewed:"Feb 2026"},
            {id:14,name:"OpenProject",slug:"openproject",category:"Project Management",alternativeTo:["asana","monday","trello"],provider:"OpenProject GmbH",hqCountry:"Germany",openSource:"Yes",selfHostable:"Yes",dataHosting:"Germany / self-hosted",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:2,total:7,approxCost:"Free (self-host) / \u20ac5.95/user/mo",migrationDifficulty:"Medium",tradeoffs:"Full-featured PM tool. Gantt, agile boards, time tracking. EU-based.",lastReviewed:"Feb 2026"},
            {id:15,name:"Vikunja",slug:"vikunja",category:"Project Management",alternativeTo:["trello","asana"],provider:"Community",hqCountry:"Open source",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted",jurisdiction:1,continuity:1,surveillance:1,lockIn:1,costExposure:1,total:5,approxCost:"Free",migrationDifficulty:"Low",tradeoffs:"Lightweight, simple. Good Trello alternative. Self-host only. Less mature.",lastReviewed:"Feb 2026"},
            {id:16,name:"WordPress.org (self-hosted)",slug:"wordpress-org",category:"Website / CMS",alternativeTo:["wordpress-com","squarespace","wix"],provider:"WordPress Foundation",hqCountry:"Global (open source)",openSource:"Yes",selfHostable:"Yes",dataHosting:"Your choice of host",jurisdiction:1,continuity:1,surveillance:1,lockIn:1,costExposure:2,total:6,approxCost:"Free + hosting (\u00a35\u201320/mo)",migrationDifficulty:"Low\u2013Medium",tradeoffs:"World\u2019s most used CMS. You control everything. Needs maintenance. Choose a UK/EU host.",lastReviewed:"Feb 2026"},
            {id:17,name:"Ghost",slug:"ghost",category:"Website / Blog",alternativeTo:["wordpress-com","medium"],provider:"Ghost Foundation",hqCountry:"Global (nonprofit)",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted / Ghost Pro (EU)",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:2,total:7,approxCost:"Free (self-host) / from $9/mo",migrationDifficulty:"Low",tradeoffs:"Clean, fast, publishing-focused. Membership/newsletter built in. Nonprofit org.",lastReviewed:"Feb 2026"},
            {id:18,name:"LimeSurvey",slug:"limesurvey",category:"Forms / Surveys",alternativeTo:["surveymonkey","google-forms"],provider:"LimeSurvey GmbH",hqCountry:"Germany",openSource:"Yes",selfHostable:"Yes",dataHosting:"Germany / self-hosted",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:2,total:7,approxCost:"Free (self-host) / from \u20ac29/mo",migrationDifficulty:"Low",tradeoffs:"Powerful survey tool. Academic-grade. Self-hostable. Data stays with you.",lastReviewed:"Feb 2026"},
            {id:19,name:"Tally",slug:"tally",category:"Forms",alternativeTo:["typeform","google-forms"],provider:"Tally Inc",hqCountry:"Belgium",openSource:"No",selfHostable:"No",dataHosting:"EU",jurisdiction:1,continuity:2,surveillance:2,lockIn:2,costExposure:1,total:8,approxCost:"Free (generous) / from \u20ac29/mo",migrationDifficulty:"Low",tradeoffs:"EU-based (Belgium). Very generous free tier. Beautiful forms. Not open source.",lastReviewed:"Feb 2026"},
            {id:20,name:"Listmonk",slug:"listmonk",category:"Email Marketing",alternativeTo:["mailchimp"],provider:"Community",hqCountry:"Open source",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted",jurisdiction:1,continuity:1,surveillance:1,lockIn:1,costExposure:1,total:5,approxCost:"Free (self-host)",migrationDifficulty:"Medium",tradeoffs:"Powerful, fast, self-hosted. Needs technical setup. No drag-drop editor.",lastReviewed:"Feb 2026"},
            {id:21,name:"Buttondown",slug:"buttondown",category:"Email Newsletter",alternativeTo:["mailchimp","substack"],provider:"Justin Duke",hqCountry:"United States",openSource:"No",selfHostable:"No",dataHosting:"US",jurisdiction:3,continuity:2,surveillance:2,lockIn:2,costExposure:2,total:11,approxCost:"Free tier / from $9/mo",migrationDifficulty:"Low",tradeoffs:"Indie-run, transparent, simple. US-based. Markdown-first. Great for newsletters.",lastReviewed:"Feb 2026"},
            {id:22,name:"Penpot",slug:"penpot",category:"Design",alternativeTo:["canva","figma"],provider:"Kaleidos Open Source SL",hqCountry:"Spain",openSource:"Yes",selfHostable:"Yes",dataHosting:"EU / self-hosted",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:1,total:6,approxCost:"Free",migrationDifficulty:"Medium",tradeoffs:"Open source Figma alternative. EU-based. Self-hostable. Growing fast.",lastReviewed:"Feb 2026"},
            {id:23,name:"Cal.com",slug:"cal-com",category:"Scheduling",alternativeTo:["calendly"],provider:"Cal.com Inc",hqCountry:"United States",openSource:"Yes",selfHostable:"Yes",dataHosting:"Self-hosted or US cloud",jurisdiction:2,continuity:2,surveillance:1,lockIn:1,costExposure:1,total:7,approxCost:"Free (self-host) / free cloud tier",migrationDifficulty:"Low",tradeoffs:"Open source Calendly alternative. Self-hostable for full sovereignty.",lastReviewed:"Feb 2026"},
            {id:24,name:"Excalidraw",slug:"excalidraw",category:"Whiteboard",alternativeTo:["miro","mural"],provider:"Community",hqCountry:"Open source",openSource:"Yes",selfHostable:"Yes",dataHosting:"Local / self-hosted",jurisdiction:1,continuity:1,surveillance:1,lockIn:1,costExposure:1,total:5,approxCost:"Free",migrationDifficulty:"Low",tradeoffs:"Beautiful hand-drawn aesthetic. No login needed. Self-hostable. Perfect for workshops.",lastReviewed:"Feb 2026"},
            {id:25,name:"Mythic Beasts",slug:"mythic-beasts",category:"Web Hosting",alternativeTo:["aws","gcp","godaddy"],provider:"Mythic Beasts Ltd",hqCountry:"United Kingdom",openSource:"No",selfHostable:"N/A",dataHosting:"UK (Cambridge)",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:2,total:7,approxCost:"From \u00a33/mo",migrationDifficulty:"Low\u2013Medium",tradeoffs:"UK-owned, UK-hosted. Excellent reputation. IPv6 pioneers. Ethical company.",lastReviewed:"Feb 2026"},
            {id:26,name:"Krystal",slug:"krystal",category:"Web Hosting",alternativeTo:["aws","gcp","godaddy"],provider:"Krystal Hosting Ltd",hqCountry:"United Kingdom",openSource:"No",selfHostable:"N/A",dataHosting:"UK",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:2,total:7,approxCost:"From \u00a35/mo",migrationDifficulty:"Low",tradeoffs:"UK-owned, UK-hosted. Carbon neutral. B Corp certified. Good WordPress hosting.",lastReviewed:"Feb 2026"},
            {id:27,name:"Hetzner",slug:"hetzner",category:"Cloud Infrastructure",alternativeTo:["aws","gcp","azure"],provider:"Hetzner Online GmbH",hqCountry:"Germany",openSource:"No",selfHostable:"N/A",dataHosting:"Germany / Finland",jurisdiction:1,continuity:2,surveillance:1,lockIn:1,costExposure:1,total:6,approxCost:"From \u20ac4/mo",migrationDifficulty:"Medium",tradeoffs:"German company, EU data centres. Excellent value. Popular in EU open source community.",lastReviewed:"Feb 2026"}
        ];

        var TOOLS = TOOLS_FALLBACK;
        var ALTERNATIVES = ALTERNATIVES_FALLBACK;

        /* ========================================
           HELPERS
           ======================================== */
        function getToolBySlug(slug) {
            for (var i = 0; i < TOOLS.length; i++) {
                if (TOOLS[i].slug === slug) return TOOLS[i];
            }
            return null;
        }

        function resolveSlug(slug) {
            return SLUG_ALIASES[slug] || slug;
        }

        function findAlternativesForTool(toolSlug) {
            var results = [];
            for (var i = 0; i < ALTERNATIVES.length; i++) {
                var alt = ALTERNATIVES[i];
                var altTo = alt.alternativeTo || [];
                for (var j = 0; j < altTo.length; j++) {
                    if (resolveSlug(altTo[j]) === toolSlug) {
                        results.push(alt);
                        break;
                    }
                }
            }
            // Sort by total score ascending (lowest/best first)
            results.sort(function(a, b) { return a.total - b.total; });
            return results;
        }

        function getRiskClass(level) {
            return (level || '').toLowerCase();
        }

        function escapeHtml(str) {
            var div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        /* ========================================
           RENDER
           ======================================== */
        function renderPage(toolSlugs) {
            var container = document.getElementById('alternatives-container');
            container.innerHTML = '';

            // Sort tool groups by risk (highest total first)
            var toolGroups = [];
            for (var i = 0; i < toolSlugs.length; i++) {
                var tool = getToolBySlug(toolSlugs[i]);
                if (tool) {
                    var alts = findAlternativesForTool(tool.slug);
                    if (alts.length > 0) {
                        toolGroups.push({ tool: tool, alternatives: alts });
                    }
                }
            }

            toolGroups.sort(function(a, b) { return b.tool.total - a.tool.total; });

            if (toolGroups.length === 0) {
                container.innerHTML = '<p class="loading-state">No alternatives found for your selected tools. We are building our database — check back soon.</p>';
                return;
            }

            for (var g = 0; g < toolGroups.length; g++) {
                var group = toolGroups[g];
                container.appendChild(renderToolGroup(group.tool, group.alternatives, toolSlugs));
            }
        }

        function renderToolGroup(tool, alternatives, allSelectedSlugs) {
            var section = document.createElement('div');
            section.className = 'tool-group';

            // Header
            var header = document.createElement('div');
            header.className = 'tool-group-header';
            header.innerHTML = '<h2>Instead of <strong>' + escapeHtml(tool.name) + '</strong></h2>' +
                '<span class="tool-group-risk ' + getRiskClass(tool.riskLevel) + '">' +
                escapeHtml(tool.riskLevel) + ' risk &middot; ' + tool.total + '/25</span>';
            section.appendChild(header);

            // Cards grid
            var grid = document.createElement('div');
            grid.className = 'alt-cards-grid';

            for (var i = 0; i < alternatives.length; i++) {
                grid.appendChild(renderCard(alternatives[i], tool.slug, allSelectedSlugs));
            }

            section.appendChild(grid);
            return section;
        }

        function renderCard(alt, currentToolSlug, allSelectedSlugs) {
            var card = document.createElement('div');
            card.className = 'alt-card';

            // --- Identity (blurred when locked) ---
            var lockedClass = IS_UNLOCKED ? '' : ' locked';
            var html = '<div class="gated-identity' + lockedClass + '">';
            html += '<h3>' + escapeHtml(alt.name) + '</h3>';
            html += '<p class="alt-card-meta">' + escapeHtml(alt.provider) + ' &middot; ' + escapeHtml(alt.hqCountry) + '</p>';
            html += '</div>';
            html += '<span class="alt-card-category">' + escapeHtml(alt.category) + '</span>';

            // Badges
            html += '<div class="alt-badges">';
            if (alt.openSource === 'Yes') {
                html += '<span class="alt-badge alt-badge--open-source">Open Source</span>';
            } else if (alt.openSource === 'Partially') {
                html += '<span class="alt-badge alt-badge--open-source">Partly Open Source</span>';
            }
            if (alt.selfHostable === 'Yes') {
                html += '<span class="alt-badge alt-badge--self-hostable">Self-Hostable</span>';
            }
            var country = (alt.hqCountry || '').toLowerCase();
            if (country.indexOf('uk') !== -1 || country.indexOf('kingdom') !== -1 ||
                country.indexOf('germany') !== -1 || country.indexOf('france') !== -1 ||
                country.indexOf('spain') !== -1 || country.indexOf('belgium') !== -1 ||
                country.indexOf('switzerland') !== -1 || country.indexOf('latvia') !== -1 ||
                country.indexOf('eu') !== -1) {
                html += '<span class="alt-badge alt-badge--eu-uk">EU / UK</span>';
            }

            // "Also replaces" badge
            var alsoReplaces = [];
            var altTo = alt.alternativeTo || [];
            for (var j = 0; j < altTo.length; j++) {
                var resolved = resolveSlug(altTo[j]);
                if (resolved !== currentToolSlug && allSelectedSlugs.indexOf(resolved) !== -1) {
                    var otherTool = getToolBySlug(resolved);
                    if (otherTool) {
                        alsoReplaces.push(otherTool.name);
                    }
                }
            }
            if (alsoReplaces.length > 0) {
                html += '<span class="alt-badge alt-badge--also-replaces">Also replaces: ' + escapeHtml(alsoReplaces.join(', ')) + '</span>';
            }

            html += '</div>';

            // --- Gated content (scores - always visible) ---
            html += '<div class="gated-content">';

            // Score cells
            html += '<div class="gated-scores">';
            var dims = [
                { key: 'jurisdiction', label: 'Juris.' },
                { key: 'continuity', label: 'Cont.' },
                { key: 'surveillance', label: 'Surv.' },
                { key: 'lockIn', label: 'Lock-in' },
                { key: 'costExposure', label: 'Cost' }
            ];
            for (var d = 0; d < dims.length; d++) {
                var score = alt[dims[d].key] || 0;
                html += '<div class="gated-score-cell">' +
                    '<span class="gated-score-label">' + dims[d].label + '</span>' +
                    '<span class="gated-score-value score-' + score + '">' + score + '</span>' +
                    '</div>';
            }
            html += '</div>';

            // Details
            if (alt.approxCost) {
                html += '<p class="gated-detail"><strong>Cost:</strong> ' + escapeHtml(alt.approxCost) + '</p>';
            }
            if (alt.migrationDifficulty) {
                html += '<p class="gated-detail"><strong>Migration:</strong> ' + escapeHtml(alt.migrationDifficulty) + '</p>';
            }
            if (alt.tradeoffs) {
                html += '<p class="gated-tradeoffs">' + escapeHtml(alt.tradeoffs) + '</p>';
            }

            html += '</div>'; // .gated-content

            // Risk comparison (bottom of card)
            var parentTool = getToolBySlug(currentToolSlug);
            if (parentTool) {
                var diff = parentTool.total - alt.total;
                var diffClass = diff > 0 ? 'improvement' : (diff < 0 ? 'worse' : 'neutral');
                var diffSign = diff > 0 ? '\u2212' : (diff < 0 ? '+' : '');
                html += '<div class="risk-comparison">';
                html += '<strong>Risk:</strong> <span class="risk-comparison-score ' + diffClass + '">' + alt.total + '/25</span>';
                if (diff !== 0) {
                    html += ' <span class="risk-comparison-diff">(' + diffSign + Math.abs(diff) + ' vs current)</span>';
                }
                html += '</div>';
            }

            card.innerHTML = html;
            return card;
        }

        /* ========================================
           DATA FETCH — twin-track
           ======================================== */
        function fetchWithTimeout(url, ms) {
            return new Promise(function(resolve, reject) {
                var timer = setTimeout(function() { reject(new Error('timeout')); }, ms);
                fetch(url).then(function(r) {
                    clearTimeout(timer);
                    if (!r.ok) reject(new Error(r.status));
                    else resolve(r.json());
                }).catch(function(err) {
                    clearTimeout(timer);
                    reject(err);
                });
            });
        }

        function fetchFromStatic() {
            return Promise.all([
                fetchWithTimeout(STATIC_BASE + '/alternatives.json', 2000),
                fetchWithTimeout(STATIC_BASE + '/tools.json', 2000)
            ]).then(function(results) {
                var altData = results[0];
                var toolData = results[1];

                if (!altData || altData.length === 0) throw new Error('No alternatives in static JSON');
                if (!toolData || toolData.length === 0) throw new Error('No tools in static JSON');

                ALTERNATIVES = altData;
                TOOLS = toolData;

                console.log('TechFreedom: Loaded ' + ALTERNATIVES.length + ' alternatives from static JSON');
                return true;
            });
        }

        function fetchFromPocketBase() {
            var altsUrl = API_BASE + '/api/collections/alternatives/records?perPage=50&sort=name';
            var toolsUrl = API_BASE + '/api/collections/tools/records?perPage=50&sort=name';

            return Promise.all([
                fetchWithTimeout(altsUrl, 5000),
                fetchWithTimeout(toolsUrl, 5000)
            ]).then(function(results) {
                var altRecords = results[0].items || [];
                var toolRecords = results[1].items || [];

                if (altRecords.length === 0) throw new Error('No alternatives returned');
                if (toolRecords.length === 0) throw new Error('No tools returned');

                TOOLS = toolRecords.map(function(r, i) {
                    return {
                        id: i + 1,
                        name: r.name,
                        slug: r.slug,
                        category: r.category,
                        provider: r.provider,
                        hqCountry: r.hqCountry,
                        jurisdiction: r.jurisdiction,
                        continuity: r.continuity,
                        surveillance: r.surveillance,
                        lockIn: r.lockIn,
                        costExposure: r.costExposure,
                        total: r.total,
                        riskLevel: r.riskLevel
                    };
                });

                ALTERNATIVES = altRecords.map(function(r, i) {
                    // PocketBase stores alternativeTo as comma-separated slugs
                    var altToStr = r.alternativeTo || '';
                    var altToArr = altToStr.split(',').filter(Boolean);
                    return {
                        id: i + 1,
                        name: r.name,
                        slug: r.slug,
                        category: r.category,
                        alternativeTo: altToArr,
                        provider: r.provider,
                        hqCountry: r.hqCountry,
                        openSource: r.openSource,
                        selfHostable: r.selfHostable,
                        dataHosting: r.dataHosting,
                        jurisdiction: r.jurisdiction,
                        continuity: r.continuity,
                        surveillance: r.surveillance,
                        lockIn: r.lockIn,
                        costExposure: r.costExposure,
                        total: r.total,
                        approxCost: r.approxCost,
                        migrationDifficulty: r.migrationDifficulty,
                        tradeoffs: r.tradeoffs,
                        lastReviewed: r.lastReviewed
                    };
                });

                console.log('TechFreedom: Loaded ' + ALTERNATIVES.length + ' alternatives from API');
                return true;
            });
        }

        function fetchData() {
            if (!window.fetch) return Promise.reject('No fetch');
            if (DATA_SOURCE === 'api') return fetchFromPocketBase();
            return fetchFromStatic();
        }

        /* ========================================
           SCROLL REVEALS
           ======================================== */
        function initScrollReveals() {
            var prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

            if (!prefersReducedMotion) {
                var observer = new IntersectionObserver(function(entries) {
                    entries.forEach(function(entry) {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, {
                    threshold: 0.15,
                    rootMargin: '0px 0px -60px 0px'
                });

                document.querySelectorAll('.reveal').forEach(function(el) {
                    observer.observe(el);
                });
            } else {
                document.querySelectorAll('.reveal').forEach(function(el) {
                    el.classList.add('visible');
                });
            }
        }

        /* ========================================
           NAV SCROLL STATE
           ======================================== */
        function initNav() {
            var nav = document.querySelector('.site-nav');
            if (!nav) return;

            nav.classList.add('scrolled');

            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 40) {
                    nav.classList.add('scrolled');
                } else {
                    nav.classList.remove('scrolled');
                }
            }, { passive: true });
        }

        /* ========================================
           INIT
           ======================================== */
        function init() {
            initNav();
            initScrollReveals();

            // Parse ?tools= parameter
            var params = new URLSearchParams(window.location.search);
            var toolsParam = params.get('tools');

            function renderUI() {
                if (!toolsParam) {
                    // No tools — show assessment prompt
                    document.getElementById('no-tools-section').hidden = false;
                    return;
                }

                var slugs = toolsParam.split(',').map(function(s) { return s.trim(); }).filter(Boolean);
                if (slugs.length === 0) {
                    document.getElementById('no-tools-section').hidden = false;
                    return;
                }

                // Show alternatives
                document.getElementById('alternatives-section').hidden = false;
                document.getElementById('unlock-section').hidden = !!(IS_UNLOCKED);
                renderPage(slugs);
            }

            fetchData().then(renderUI).catch(function() {
                TOOLS = TOOLS_FALLBACK;
                ALTERNATIVES = ALTERNATIVES_FALLBACK;
                console.log('TechFreedom: Using embedded fallback data');
                renderUI();
            });
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    })();
    </script>
</body>
</html>
